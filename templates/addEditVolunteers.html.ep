<!DOCTYPE html>

<html>
<head>
	<link rel="stylesheet" href="/site.css">
</head>

<script src="/scheduler.js"> </script>

<script>

	//==============================================================================
	//	function removeEntry()
	//		This function removes the selected entry in the volunteer list from the
	//		"positions" table.
	//==============================================================================
	function removeEntry()
	{
		var itemList = document.getElementById( "itemList");
		var selectedItem = itemList.value;
		var message = JSON.stringify( { 'name': selectedItem});
		
		hideConfirmDelete();

		fetch( '<%= url_for( 'removeVolunteer')->to_abs %>' ,
				{
					method: "POST",
					body: JSON.stringify( { 'name': selectedItem}),
					headers: { "Content-type": "application/json"}
				}
			  )
		.then( response => 
				{
					window.location.reload();
				});
	}

	window.addEventListener( "pageshow", showVolunteerInfo);

</script>


<!--=================================-->
<!--| HTML for the page starts here |-->
<!--=================================-->
<body>
<div id="navbar">
</div>

<div id="overlay" hidden >
	<div class="popup" id="confirmSave" hidden>
		<h2>Save Entry</h2>
		<p>Do you wish to save this as a new position or modify the selected position?</p>
		<button onclick="addEntry()">New Position</button>
		<button onclick="modifyEntry()">Modify Position</button>
		<button onclick="hideConfirmSave();showPosition()">Cancel</button>
	</div>
	<div class="popup" id="confirmDelete" hidden>
		<h2>Delete Entry</h2>
		<p>Are you sure that you wish to delete the entry for "<span id="itemToDelete"></span>"?</p>
		<button onclick="removeEntry()">Yes</button>
		<button onclick="hideConfirmDelete()">No</button>
	</div>
</div>

<h1><%= $title %></h1>

<div id="holder">
	<div id="userInfo">
		<form>
		<label for="name">Name:</label>
		<input type="text" id="name" name="name" value="<%= (defined($volunteer))? $volunteer->{name} : "" %>"></input>
		<br>
		<label for="email">Email address:</label>
		<input type="email" id="email" name="email" value="<%= (defined($volunteer))? $volunteer->{email} : "" %>"></input>
		<br>
		<label for="phone">Phone number:</label>
		<input type="tel" id="phone" name="phone" pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}" value="<%= (defined($volunteer))? $volunteer->{phone} : "" %>"></input>
		<br>
		<label for="positions">Positions:</label>

		% my @roles;
		% if ( defined( $volunteer))
		% {
		%    @roles = split(",", $volunteer->{desiredRoles});
		% }
		% else
		% {
		%    foreach ( @$slots)
		%	 {
		%		push( @roles, $_->{title});
		%    }
		% }
		% my $roleCount = int( @roles);
		<select name="positions" id="positions" multiple size="<%= ($roleCount)? (($roleCount > 3) ? 3: $roleCount) : 1 %>">
		% if ( @roles)
		% {
		%  foreach my $role (@roles)
		%    {
			<option value="<%= $role %>"><%= $role %></option>
		%    }
		% }
		% else
		% {
			<option value="-none-"></option>
		% }
		</select>
		<br>
		<label for="daysUnavailable">Days unavailable:</label>

		% my @daysUnavailable;
		% if ( defined( $volunteer) && defined( $volunteer->{daysUnavailable}))
		% {
		%    @daysUnavailable = split(",", $volunteer->{daysUnavailable});
		% }
		% my $count = int( @daysUnavailable);
		<select name="daysUnavailable" id="daysUnavailable" multiple size="<%= ($count)? (($count > 3) ? 3 : $count) : 1 %>">
		% if ( @daysUnavailable)
		% {
		%  foreach my $day (@daysUnavailable)
		%    {
			<option value="<%= $day %>"><%= $day %></option>
		%    }
		% }
		% else
		% {
			<option value="-none-">-none-</option>
		% }
		</select>
		</select>
		<button type="button">Edit</button>
		<br>
		<label for="daysDesired">Days desired:</label>
		% my @daysDesired;
		% if ( defined( $volunteer) && defined( $volunteer->{daysDesired}))
		% {
		%    @daysDesired = split(",", $volunteer->{daysDesired});
		% }
		% $count = int( @daysDesired);
		<select name="daysDesired" id="daysDesired" multiple size="<%= ($count)? (($count > 3) ? 3 : $count) : 1 %>">
		% if ( @daysDesired)
		% {
		%  foreach my $day (@daysDesired)
		%    {
			<option value="<%= $day %>"><%= $day %></option>
		%    }
		% }
		% else
		% {
			<option value="-none-">-none-</option>
		% }
		</select>
		<button type="button">Edit</button>

		<br>
		<button type="button" onclick="showConfirmSave()">Save</button>
		<button type="button" onclick="showConfirmDelete()">Cancel</button>
		</form>
	</div>
</div>
</body>

</html>

